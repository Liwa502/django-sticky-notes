{% extends 'notes/base.html' %}
{# Inherits from the base template for consistent layout, styles, and scripts #}

{% block title %}Sticky Notes{% endblock %}
{# Sets the page title shown in the browser tab #}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Your Sticky Notes</h2>
  {# Page heading for the notes list #}

  <a href="{% url 'note_create' %}" class="btn btn-primary">Add New Note</a>
  {# Button to create a new note - links to the note creation view #}
</div>

{% if notes %}
  {# If there are notes in the database, display them in a grid layout #}
  <div class="row">
    {% for note in notes %}
      {# Loop through each note in the notes list #}
      <div class="col-md-6 col-lg-4">
        {# Responsive column layout for different screen sizes #}

        <div class="note-card {% if note.pinned %}note-pinned{% endif %}">
          {# Main note container; adds "note-pinned" class if the note is pinned #}

          <h3 class="note-title">{{ note.title }}</h3>
          {# Displays the note title #}

          <p class="note-content">{{ note.content|linebreaksbr }}</p>
          {# Displays the note content, preserving line breaks using the 'linebreaksbr' filter #}

          {% if note.due_date %}
            <p class="text-muted small">Due: {{ note.due_date|date:"M d, Y" }}</p>
            {# If a due date exists, display it in a readable format (e.g., Aug 12, 2025) #}
          {% endif %}

          <div class="mt-3 d-flex justify-content-between align-items-center">
            {# Section for note actions (edit, delete, pin/unpin) #}
            <div>
              <a href="{% url 'note_update' note.pk %}" class="btn btn-sm btn-outline-primary">Edit</a>
              {# Link to update/edit the current note #}

              <a href="{% url 'note_delete' note.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
              {# Link to delete the current note #}
            </div>

            <form method="post" action="{% url 'note_toggle_pin' note.pk %}">
              {% csrf_token %}
              {# CSRF token for security on form submissions #}

              <button type="submit" class="btn btn-sm {% if note.pinned %}btn-danger{% else %}btn-outline-secondary{% endif %}" title="{% if note.pinned %}Unpin{% else %}Pin{% endif %}">
                {# Button changes style and tooltip depending on whether the note is pinned #}
                {% if note.pinned %}üìå{% else %}üìç{% endif %}
                {# Shows a filled pin emoji if pinned, otherwise a hollow pin emoji #}
              </button>
            </form>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  {# If no notes exist, show a friendly message #}
  <p>No sticky notes yet. Start by adding one!</p>
{% endif %}
{% endblock %}
